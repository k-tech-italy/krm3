{% extends "base.html" %}
{% load static tailwind_tags i18n %}

{% block head-title %}
    {% blocktrans with title=expense.mission.title %}Upload image for {{ title }}{% endblocktrans %}
{% endblock %}

{% block head %}
    <meta name="otp" content="{{ request.GET.otp }}">
    {% tailwind_css %}
{% endblock %}

{% block body %}
    <div class="upload-image-body">
        <div class="upload-image-container">
            <div class="upload-image-login-bar">
            {% if not is_authenticated %}
                <a href="/admin/login/?next={{ current_url }}" class="upload-image-btn-primary">{% trans "Login" %}</a>
            {% else %}
                <a href="/" class="upload-image-btn-primary">{% trans "Back" %}</a>
            {% endif %}
            </div>
            {% if is_authenticated %}
            <div class="upload-image-expense-info">
                <table class="upload-image-expense-table">
                    <tbody>
                        <tr>
                            <th>{% trans "Day" %}</th>
                            <td>{{ expense.day }}</td>
                        </tr>
                        <tr>
                            <th>{% trans "Mission" %}</th>
                            <td>{{ expense.mission.title }}</td>
                        </tr>
                        <tr>
                            <th>{% trans "Project" %}</th>
                            <td>{{ expense.mission.project.name }}</td>
                        </tr>
                        <tr>
                            <th>{% trans "City" %}</th>
                            <td>{{ expense.mission.city.name }}</td>
                        </tr>
                        <tr>
                            <th>{% trans "Resource" %}</th>
                            <td>{{ expense.mission.resource.first_name }} {{ expense.mission.resource.last_name }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            {% endif %}
            <div class="upload-image-header-section">
                {% if not is_authenticated %}
                <h2 class="upload-image-heading">{% blocktrans with title=expense.mission.title %}Upload image for {{ title }}{% endblocktrans %}</h2>
                {% endif %}
                <div class="upload-image-button-group">
                    <button type="button" id="fileSelectBtn" class="upload-image-button upload-image-btn-primary">{% trans "Choose File" %}</button>
                    <button type="button" id="cameraBtn" class="upload-image-button upload-image-btn-primary">{% trans "Use Camera" %}</button>
                </div>
            </div>

            <input type="file" id="fileInput" class="upload-image-file-input" accept="image/*">

            <div class="upload-image-video-container">
                <video id="video" class="upload-image-video" autoplay playsinline></video>
                <button type="button" id="captureBtn" class="upload-image-button upload-image-btn-primary upload-image-capture-btn" style="display: none; margin-top: 10px;">{% trans "Capture Photo" %}</button>
            </div>

            <div id="imagePreview" class="upload-image-preview">
                <img id="previewImg" class="upload-image-preview-img" src="" alt="{% trans 'Image preview' %}">
                <button type="button" id="removeBtn" class="upload-image-button upload-image-remove-btn" title="{% trans 'Remove image' %}">Ã—</button>
                <button type="button" id="recaptureBtn" class="upload-image-button upload-image-recapture-btn" title="{% trans 'Recapture photo' %}">
                    <img src="{% static 'missions/img/re-camera.png' %}" alt="{% trans 'Recapture' %}">
                </button>
            </div>

            <button type="button" id="submitBtn" class="upload-image-button upload-image-btn-success">{% trans "Submit Image" %}</button>

            <div id="spinner" class="upload-image-spinner"></div>

            <div id="message" class="upload-image-message"></div>
        </div>
    </div>
{% endblock body %}

{% block js-frameworks %}
    <script src="{% static 'missions/js/upload_image.js' %}"></script>
{% endblock js-frameworks %}
